
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lenguas Ind√≠genas de Colombia</title>
    <meta name="description" content="Plataforma educativa para aprender lenguas ind√≠genas de Colombia">
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Nunito', system-ui, -apple-system, sans-serif;
            background: #1a0f08;
            color: #f5e6d3;
        }

        .ethnic-pattern {
            background-color: #3a2818;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(139, 69, 19, 0.15) 35px, rgba(139, 69, 19, 0.15) 70px),
                repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(160, 82, 45, 0.15) 35px, rgba(160, 82, 45, 0.15) 70px);
            min-height: 100vh;
            padding: 1.5rem;
        }

        .woven-texture {
            background-image: 
                linear-gradient(90deg, rgba(139, 69, 19, 0.05) 1px, transparent 1px),
                linear-gradient(rgba(139, 69, 19, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .container { max-width: 1200px; margin: 0 auto; }
        .container-sm { max-width: 800px; margin: 0 auto; }

        .card {
            background: linear-gradient(135deg, #9d6b4a 0%, #7a5434 100%);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 3px solid #d4a574;
            box-shadow: 0 12px 36px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover { transform: translateY(-4px); box-shadow: 0 16px 42px rgba(0, 0, 0, 0.5); }
        .card-static { cursor: default; }
        .card-static:hover { transform: none; }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .lang-card {
            padding: 1.25rem;
            min-height: auto;
        }

        @media (max-width: 1024px) {
            .grid-3 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 640px) {
            .grid-3 {
                grid-template-columns: 1fr;
            }
        }

        .btn {
            padding: 1.25rem 2rem;
            border: none;
            border-radius: 1rem;
            font-weight: bold;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            font-family: inherit;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: left 0.3s ease;
            z-index: 0;
        }

        .btn:hover::before { left: 100%; }
        .btn > * { position: relative; z-index: 1; }

        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        .btn-primary {
            background: linear-gradient(135deg, #d4854a 0%, #b35f35 100%);
            color: #fff;
            box-shadow: 0 6px 16px rgba(212, 133, 74, 0.5);
            font-weight: 800;
        }

        .btn-secondary {
            background: rgba(139, 69, 19, 0.6);
            color: #f5e6d3;
            border: 2px solid rgba(212, 165, 116, 0.5);
        }

        .badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .badge-ochre { background: #e8c490; color: #3d2410; font-weight: 800; }
        .badge-warning { 
            background: rgba(234, 179, 8, 0.3); 
            border: 2px solid rgb(161, 98, 7); 
            color: rgb(254, 240, 138); 
        }

        .text-center { text-align: center; }
        .text-ochre { color: #e8c490; }
        .text-sand { color: #f5e6d3; }

        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mb-12 { margin-bottom: 3rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-8 { margin-top: 2rem; }
        .mt-12 { margin-top: 3rem; }

        .text-sm { font-size: 0.875rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }
        .text-5xl { font-size: 3rem; }
        .text-7xl { font-size: 4.5rem; }
        .text-8xl { font-size: 6rem; }

        .font-bold { font-weight: 700; }
        .italic { font-style: italic; }

        .float-animation { animation: float 3s ease-in-out infinite; }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes slideInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .animate-pulse { animation: pulse 2s ease-in-out infinite; }
        .animate-slideInDown { animation: slideInDown 0.4s ease-out; }
        .animate-slideInUp { animation: slideInUp 0.4s ease-out; }
        .animate-scaleIn { animation: scaleIn 0.3s ease-out; }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4a7c59 0%, #2f5d3c 100%);
            color: #f5e6d3;
            padding: 1.5rem 2rem;
            border-radius: 1rem;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
            animation: slideInDown 0.4s ease-out;
            border: 2px solid #6ba375;
            max-width: 400px;
            z-index: 9999;
        }

        .toast.achievement {
            background: linear-gradient(135deg, #d4854a 0%, #b8652f 100%);
            border-color: #e8c490;
        }

        .toast-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .toast-icon {
            font-size: 2.5rem;
            animation: scaleIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .toast-text h3 {
            margin: 0;
            font-size: 1.25rem;
            font-weight: 800;
        }

        .toast-text p {
            margin: 0.25rem 0 0 0;
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .badge-item {
            text-align: center;
            padding: 1rem;
            border-radius: 1rem;
            background: rgba(139, 69, 19, 0.2);
            border: 2px solid rgba(212, 165, 116, 0.3);
            transition: all 0.3s ease;
        }

        .badge-item.unlocked {
            background: rgba(212, 133, 74, 0.2);
            border-color: #d4854a;
            box-shadow: 0 4px 12px rgba(212, 133, 74, 0.3);
        }

        .badge-item.locked {
            opacity: 0.4;
        }

        .badge-item:hover { transform: scale(1.05); }

        .badge-icon {
            font-size: 2.5rem;
            display: block;
            margin-bottom: 0.5rem;
        }

        .badge-name {
            font-size: 0.85rem;
            font-weight: 700;
            color: #e8c490;
            margin: 0.5rem 0 0 0;
        }

        .badge-desc {
            font-size: 0.7rem;
            color: #d4a574;
            margin: 0.25rem 0 0 0;
        }

        .settings-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 9999px;
            background: linear-gradient(135deg, #d4854a 0%, #b8652f 100%);
            border: none;
            color: #fff;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(212, 133, 74, 0.4);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            z-index: 100;
        }

        .settings-btn:hover { transform: scale(1.1) rotate(20deg); }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #8b5a3c 0%, #6d4423 100%);
            border: 3px solid #d4a574;
            border-radius: 1.5rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
            z-index: 1001;
            animation: slideInUp 0.4s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.75rem;
            font-weight: 800;
            color: #e8c490;
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            color: #e8c490;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 0;
            width: 40px;
            height: 40px;
        }

        .close-btn:hover { transform: rotate(90deg); color: #f5e6d3; }

        .settings-group {
            margin-bottom: 1.5rem;
        }

        .settings-label {
            display: block;
            color: #e8c490;
            font-weight: 700;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 28px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(139, 69, 19, 0.4);
            transition: 0.3s;
            border-radius: 28px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: #d4a574;
            transition: 0.3s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4a7c59;
        }

        input:checked + .slider:before {
            transform: translateX(22px);
            background-color: #8ef59e;
        }

        .decorative-dots {
            display: flex;
            justify-content: center;
            gap: 0.25rem;
            margin: 1rem 0;
        }

        .dot { width: 0.5rem; height: 0.5rem; border-radius: 50%; }

        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .gap-4 { gap: 1rem; }

        .grid { display: grid; gap: 1.5rem; }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }

        .icon-btn {
            background: rgba(139, 69, 19, 0.3);
            border: 2px solid rgba(212, 165, 116, 0.2);
            padding: 0.75rem;
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            color: #f5e6d3;
        }

        .icon-btn:hover { background: #e8c490; color: #3d2410; transform: scale(1.1) rotate(-5deg); }

        .icon { width: 1.5rem; height: 1.5rem; }

        .stats-card {
            background: linear-gradient(135deg, #9d6b4a 0%, #7a5434 100%);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            border: 2px solid #d4a574;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }

        .stats-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0, 0, 0, 0.4); }

        .lesson-card {
            background: rgba(139, 69, 19, 0.3);
            border: 2px solid rgba(212, 165, 116, 0.2);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            margin-bottom: 1rem;
        }

        .lesson-card:not(.locked):hover { background: rgba(139, 69, 19, 0.5); border-color: #d4a574; transform: translateX(4px); }
        .lesson-card.locked { opacity: 0.5; cursor: not-allowed; }

        .option-btn {
            width: 100%;
            padding: 1.5rem;
            background: rgba(139, 69, 19, 0.4);
            border: 2px solid rgba(212, 165, 116, 0.3);
            border-radius: 1rem;
            color: #f5e6d3;
            font-weight: bold;
            font-size: 1.25rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: inherit;
            margin-bottom: 1rem;
        }

        .option-btn:hover:not(:disabled) {
            background: #e8c490;
            color: #3d2410;
            transform: scale(1.03);
            border: 2px solid #f5e6d3;
            font-weight: 700;
        }

        .option-btn.correct { background: linear-gradient(135deg, #4a7c59 0%, #2f5d3c 100%); }
        .option-btn.incorrect { background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%); }

        .bg-accent { background: rgba(139, 69, 19, 0.3); border-radius: 1rem; padding: 1.5rem; }

        .pt-12 { padding-top: 3rem; }
        .pt-20 { padding-top: 5rem; }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(139, 69, 19, 0.3);
            border-radius: 9999px;
            overflow: hidden;
            margin: 1rem 0;
            border: 1px solid rgba(212, 165, 116, 0.3);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #d4854a 0%, #e8c490 100%);
            border-radius: 9999px;
            transition: width 0.4s ease;
            box-shadow: 0 0 8px rgba(212, 133, 74, 0.6);
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: #d4a574;
            margin-top: 0.5rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .text-7xl { font-size: 2.5rem; }
            .text-8xl { font-size: 3.5rem; }
            .text-5xl { font-size: 2rem; }
            .text-4xl { font-size: 1.75rem; }
            .text-3xl { font-size: 1.5rem; }
            .text-2xl { font-size: 1.25rem; }
            
            .card { padding: 1.5rem; gap: 1rem; }
            .btn { padding: 1rem 1.5rem; font-size: 1.125rem; }
            .option-btn { padding: 1.25rem; font-size: 1rem; }
            .icon-btn { padding: 0.6rem; }
            
            .flex { flex-wrap: wrap; }
            .lesson-card { padding: 1.25rem; }
            .stats-card { padding: 1.5rem; }
            
            .pt-12 { padding-top: 2rem; }
            .pt-20 { padding-top: 3rem; }
            .mb-12 { margin-bottom: 2rem; }
            .mb-8 { margin-bottom: 1.5rem; }
            
            .ethnic-pattern { padding: 1rem; }
            
            .progress-bar { margin: 0.75rem 0; }
            .progress-text { font-size: 0.75rem; }

            .settings-btn { width: 50px; height: 50px; font-size: 1.25rem; }
            .modal-content { width: 95%; max-width: 95%; }
            .badges-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, createElement: h } = React;

        const Storage = {
            loadProgress(languageId) {
                try {
                    const data = localStorage.getItem('progress:' + languageId);
                    return data ? JSON.parse(data) : null;
                } catch (e) { return null; }
            },
            saveProgress(progress) {
                try {
                    localStorage.setItem('progress:' + progress.languageId, JSON.stringify(progress));
                    return true;
                } catch (err) {
                    console.error('Storage error:', err);
                    return false;
                }
            }
        };

        class AudioEngine {
            static isAvailable() {
                return typeof window !== 'undefined' && 'speechSynthesis' in window;
            }
            static speak(text) {
                if (!this.isAvailable()) return;
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'es-ES';
                utterance.rate = 0.8;
                window.speechSynthesis.speak(utterance);
            }
            static stop() {
                if (this.isAvailable()) window.speechSynthesis.cancel();
            }
        }

        const LANGUAGES = [{
            id: 'nasa-yuwe',
            name: 'Nasa Yuwe',
            nativeName: 'Nasa Yuwe',
            region: 'Cauca, Huila, Valle del Cauca',
            speakers: '~100,000',
            icon: 'üèîÔ∏è'
        },
        {
            id: 'wayuu',
            name: 'Wayuu',
            nativeName: 'Wayuunaiki',
            region: 'La Guajira, Norte de Santander',
            speakers: '~400,000',
            icon: 'üåµ'
        },
        {
            id: 'kogi',
            name: 'Kogi',
            nativeName: 'Kagaba',
            region: 'Sierra Nevada de Santa Marta',
            speakers: '~14,000',
            icon: '‚õ∞Ô∏è'
        }];

        const LESSONS = {
            'nasa-yuwe': [
                {
                    id: 'basics-1',
                    title: 'Saludos y Cortes√≠a',
                    level: 1,
                    icon: 'üëã',
                    words: [
                        { id: 'w1', nasa: 'KsxaÃ±wÃ±', spanish: 'Hola / Buenos d√≠as', context: 'Saludo general', pronunciation: 'ksha-w' },
                        { id: 'w2', nasa: 'KweÃ±sx', spanish: 'Buenas tardes', context: 'Saludo de tarde', pronunciation: 'kwesh' },
                        { id: 'w3', nasa: 'YuÃ±', spanish: 'S√≠', context: 'Afirmaci√≥n', pronunciation: 'yu' },
                        { id: 'w4', nasa: 'NaÃ±h', spanish: 'No', context: 'Negaci√≥n', pronunciation: 'nah' },
                        { id: 'w5', nasa: 'UkxniÃ±h', spanish: 'Gracias', context: 'Agradecimiento', pronunciation: 'ush-nih' }
                    ]
                },
                {
                    id: 'basics-2',
                    title: 'Familia y Naturaleza',
                    level: 1,
                    icon: 'üåø',
                    words: [
                        { id: 'w6', nasa: 'Kiwe', spanish: 'Tierra', context: 'Concepto fundamental', pronunciation: 'ki-we' },
                        { id: 'w7', nasa: 'Uma', spanish: 'Agua', context: 'Elemento vital', pronunciation: 'u-ma' },
                        { id: 'w8', nasa: 'Tay', spanish: 'Padre', context: 'Figura paterna', pronunciation: 'tai' },
                        { id: 'w9', nasa: 'Nasa', spanish: 'Persona', context: 'Autodenominaci√≥n', pronunciation: 'na-sa' },
                        { id: 'w10', nasa: 'Wala', spanish: 'Ni√±o', context: 'Menor de edad', pronunciation: 'wa-la' }
                    ]
                },
                {
                    id: 'basics-3',
                    title: 'Cosmos y Elementos',
                    level: 2,
                    icon: '‚òÄÔ∏è',
                    words: [
                        { id: 'w11', nasa: 'Sek', spanish: 'Sol', context: 'Astro rey', pronunciation: 'sek' },
                        { id: 'w12', nasa: 'KsxaÃ±w ksxaÃ±w', spanish: 'Lluvia', context: 'Precipitaci√≥n', pronunciation: 'ksha-w' },
                        { id: 'w13', nasa: 'TxiÃ±', spanish: 'Luna', context: 'Sat√©lite', pronunciation: 'tshi' },
                        { id: 'w14', nasa: 'Yat', spanish: 'Casa', context: 'Vivienda', pronunciation: 'yat' },
                        { id: 'w15', nasa: 'Yuu', spanish: 'Monta√±a', context: 'Elevaci√≥n', pronunciation: 'yu-u' }
                    ]
                },
                {
                    id: 'basics-4',
                    title: 'N√∫meros y Caminos',
                    level: 2,
                    icon: 'üî¢',
                    words: [
                        { id: 'w16', nasa: 'Tee√ß', spanish: 'Uno', context: 'Primer n√∫mero', pronunciation: 'te-ech' },
                        { id: 'w17', nasa: 'Piy√£', spanish: 'Dos', context: 'Segundo n√∫mero', pronunciation: 'pi-yan' },
                        { id: 'w18', nasa: 'P√£kx', spanish: 'Tres', context: 'Tercer n√∫mero', pronunciation: 'panksh' },
                        { id: 'w19', nasa: 'Yak', spanish: 'Camino', context: 'Sendero', pronunciation: 'yak' },
                        { id: 'w20', nasa: 'Th√´', spanish: '√Årbol', context: 'Planta', pronunciation: 'the' }
                    ]
                }
            ],
            'wayuu': [
                {
                    id: 'wayuu-basics-1',
                    title: 'Saludos Wayuu',
                    level: 1,
                    icon: 'üëã',
                    words: [
                        { id: 'wy1', wayuu: 'Koko makalii', spanish: 'Hola (amigo/a)', context: 'Saludo informal', pronunciation: 'ko-ko mak-a-li' },
                        { id: 'wy2', wayuu: 'Akuin', spanish: 'Buenas noches', context: 'Saludo nocturno', pronunciation: 'a-kwin' },
                        { id: 'wy3', wayuu: 'Ouala', spanish: 'S√≠', context: 'Afirmaci√≥n', pronunciation: 'o-wa-la' },
                        { id: 'wy4', wayuu: 'Noula', spanish: 'No', context: 'Negaci√≥n', pronunciation: 'no-u-la' },
                        { id: 'wy5', wayuu: 'Palaa', spanish: 'Gracias', context: 'Agradecimiento', pronunciation: 'pa-la-a' }
                    ]
                },
                {
                    id: 'wayuu-basics-2',
                    title: 'Naturaleza Guajira',
                    level: 1,
                    icon: 'üèúÔ∏è',
                    words: [
                        { id: 'wy6', wayuu: 'Pula', spanish: 'Tierra', context: 'La tierra', pronunciation: 'pu-la' },
                        { id: 'wy7', wayuu: 'Ataa', spanish: 'Agua', context: 'Elemento vital', pronunciation: 'a-ta-a' },
                        { id: 'wy8', wayuu: 'Kashi', spanish: 'Sol', context: 'Astro principal', pronunciation: 'ka-shi' },
                        { id: 'wy9', wayuu: 'Maku', spanish: 'Luna', context: 'Sat√©lite nocturno', pronunciation: 'ma-ku' },
                        { id: 'wy10', wayuu: 'A√ºla', spanish: 'Mar', context: 'Oc√©ano Caribe', pronunciation: 'a-u-la' }
                    ]
                },
                {
                    id: 'wayuu-basics-3',
                    title: 'Familia Wayuu',
                    level: 2,
                    icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
                    words: [
                        { id: 'wy11', wayuu: 'Abuya', spanish: 'Padre', context: 'Figura paterna', pronunciation: 'a-bu-ya' },
                        { id: 'wy12', wayuu: 'A√±a', spanish: 'Madre', context: 'Figura materna', pronunciation: 'a-nya' },
                        { id: 'wy13', wayuu: 'Ap√ºshi', spanish: 'Hermano', context: 'Hermano var√≥n', pronunciation: 'a-pu-shi' },
                        { id: 'wy14', wayuu: 'Ata', spanish: 'Hermana', context: 'Hermana mujer', pronunciation: 'a-ta' },
                        { id: 'wy15', wayuu: 'Achiki', spanish: 'Hijo', context: 'Descendencia', pronunciation: 'a-chi-ki' }
                    ]
                },
                {
                    id: 'wayuu-basics-4',
                    title: 'N√∫meros Wayuu',
                    level: 2,
                    icon: 'üî¢',
                    words: [
                        { id: 'wy16', wayuu: 'Suu', spanish: 'Uno', context: 'Primer n√∫mero', pronunciation: 'su-u' },
                        { id: 'wy17', wayuu: 'Paa', spanish: 'Dos', context: 'Segundo n√∫mero', pronunciation: 'pa-a' },
                        { id: 'wy18', wayuu: 'Shoupo', spanish: 'Tres', context: 'Tercer n√∫mero', pronunciation: 'sho-u-po' },
                        { id: 'wy19', wayuu: 'Iipa', spanish: 'Cuatro', context: 'Cuarto n√∫mero', pronunciation: 'i-pa' },
                        { id: 'wy20', wayuu: 'Maa', spanish: 'Cinco', context: 'Quinto n√∫mero', pronunciation: 'ma-a' }
                    ]
                }
            ],
            'kogi': [
                {
                    id: 'kogi-basics-1',
                    title: 'Saludos Kogi',
                    level: 1,
                    icon: 'üëã',
                    words: [
                        { id: 'kg1', kogi: 'Gaira', spanish: 'Hola', context: 'Saludo general', pronunciation: 'gai-ra' },
                        { id: 'kg2', kogi: 'Gaira mena', spanish: 'Buenos d√≠as', context: 'Saludo matutino', pronunciation: 'gai-ra me-na' },
                        { id: 'kg3', kogi: 'Ee', spanish: 'S√≠', context: 'Afirmaci√≥n', pronunciation: 'e' },
                        { id: 'kg4', kogi: 'Aka', spanish: 'No', context: 'Negaci√≥n', pronunciation: 'a-ka' },
                        { id: 'kg5', kogi: 'Takira', spanish: 'Gracias', context: 'Agradecimiento', pronunciation: 'ta-ki-ra' }
                    ]
                },
                {
                    id: 'kogi-basics-2',
                    title: 'Sierra Nevada',
                    level: 1,
                    icon: '‚õ∞Ô∏è',
                    words: [
                        { id: 'kg6', kogi: 'Kaku', spanish: 'Tierra', context: 'La tierra sagrada', pronunciation: 'ka-ku' },
                        { id: 'kg7', kogi: 'Sati', spanish: 'Agua', context: 'Agua sagrada', pronunciation: 'sa-ti' },
                        { id: 'kg8', kogi: 'Sika', spanish: 'Sol', context: 'Astro sagrado', pronunciation: 'si-ka' },
                        { id: 'kg9', kogi: 'Yie', spanish: 'Luna', context: 'Evento lunar', pronunciation: 'yi-e' },
                        { id: 'kg10', kogi: 'Tuma', spanish: 'Monta√±a', context: 'Elevaci√≥n sagrada', pronunciation: 'tu-ma' }
                    ]
                },
                {
                    id: 'kogi-basics-3',
                    title: 'Familia Kogi',
                    level: 2,
                    icon: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
                    words: [
                        { id: 'kg11', kogi: 'Tata', spanish: 'Padre', context: 'Padre de la casa', pronunciation: 'ta-ta' },
                        { id: 'kg12', kogi: 'Nana', spanish: 'Madre', context: 'Madre de la casa', pronunciation: 'na-na' },
                        { id: 'kg13', kogi: 'Mani', spanish: 'Hermano', context: 'V√≠nculo familiar', pronunciation: 'ma-ni' },
                        { id: 'kg14', kogi: 'Kabu', spanish: 'Hermana', context: 'V√≠nculo familiar', pronunciation: 'ka-bu' },
                        { id: 'kg15', kogi: 'Atika', spanish: 'Hijo', context: 'Descendencia', pronunciation: 'a-ti-ka' }
                    ]
                },
                {
                    id: 'kogi-basics-4',
                    title: 'N√∫meros Sagrados',
                    level: 2,
                    icon: 'üî¢',
                    words: [
                        { id: 'kg16', kogi: 'Asa', spanish: 'Uno', context: 'Primer n√∫mero', pronunciation: 'a-sa' },
                        { id: 'kg17', kogi: 'Bie', spanish: 'Dos', context: 'Segundo n√∫mero', pronunciation: 'bi-e' },
                        { id: 'kg18', kogi: 'Bita', spanish: 'Tres', context: 'Tercer n√∫mero', pronunciation: 'bi-ta' },
                        { id: 'kg19', kogi: 'Sata', spanish: 'Cuatro', context: 'Cuarto n√∫mero', pronunciation: 'sa-ta' },
                        { id: 'kg20', kogi: 'Tatai', spanish: 'Cinco', context: 'Quinto n√∫mero', pronunciation: 'ta-tai' }
                    ]
                }
            ]
        };

        const ACHIEVEMENTS = [
            { id: 'first_word', name: 'Primer Paso', icon: 'üå±', description: 'Aprender la primera palabra', check: (p) => Object.keys(p.wordsLearned).length >= 1 },
            { id: 'five_words', name: 'En Crecimiento', icon: 'üåø', description: 'Aprender 5 palabras', check: (p) => Object.keys(p.wordsLearned).length >= 5 },
            { id: 'lesson_master', name: 'Maestro de Lecci√≥n', icon: 'üìö', description: 'Completar una lecci√≥n', check: (p) => p.completedLessons.length >= 1 },
            { id: 'accuracy_pro', name: 'Precisi√≥n Pro', icon: 'üéØ', description: '90% de precisi√≥n', check: (p) => LearningEngine.getAccuracy(p) >= 90 },
            { id: 'twenty_words', name: 'Experto', icon: 'üå≥', description: 'Aprender 20 palabras', check: (p) => Object.keys(p.wordsLearned).length >= 20 },
            { id: 'streak_master', name: 'Racha de Fuego', icon: 'üî•', description: '5 d√≠as de racha', check: (p) => p.streak >= 5 },
            { id: 'perfectionist', name: 'Perfeccionista', icon: 'üíØ', description: '100% en una lecci√≥n', check: (p) => p.lastLessonScore === 100 },
            { id: 'all_lessons', name: 'Campe√≥n', icon: 'üèÜ', description: 'Completar todas las lecciones', check: (p) => p.completedLessons.length >= 4 }
        ];

        class LearningEngine {
            static initProgress(languageId) {
                return {
                    languageId,
                    completedLessons: [],
                    wordsLearned: {},
                    totalAttempts: 0,
                    correctAnswers: 0,
                    streak: 1,
                    audioEnabled: true,
                    achievements: [],
                    lastLessonScore: 0,
                    firstTimeToday: true
                };
            }
            static completeLesson(progress, lessonId, score) {
                const percent = Math.round((score.correct / score.total) * 100);
                return Object.assign({}, progress, {
                    completedLessons: [...progress.completedLessons, lessonId],
                    totalAttempts: progress.totalAttempts + score.total,
                    correctAnswers: progress.correctAnswers + score.correct,
                    lastLessonScore: percent
                });
            }
            static learnWord(progress, wordId) {
                return Object.assign({}, progress, {
                    wordsLearned: Object.assign({}, progress.wordsLearned, {
                        [wordId]: { learned: new Date().toISOString() }
                    })
                });
            }
            static checkAchievements(progress) {
                const newAchievements = [];
                ACHIEVEMENTS.forEach(ach => {
                    if (!progress.achievements.includes(ach.id) && ach.check(progress)) {
                        newAchievements.push(ach.id);
                    }
                });
                return Object.assign({}, progress, {
                    achievements: [...progress.achievements, ...newAchievements]
                });
            }
            static getUnlockedBadges(progress) {
                return ACHIEVEMENTS.filter(a => progress.achievements.includes(a.id));
            }
            static getAccuracy(progress) {
                if (progress.totalAttempts === 0) return 0;
                return Math.round((progress.correctAnswers / progress.totalAttempts) * 100);
            }
            static getTotalWords(progress) {
                return Object.keys(progress.wordsLearned).length;
            }
        }

        function Icon({ name }) {
            const paths = {
                home: "M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6",
                volume: "M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z",
                check: "M5 13l4 4L19 7",
                x: "M6 18L18 6M6 6l12 12"
            };
            return h('svg', { className: 'icon', fill: 'none', stroke: 'currentColor', viewBox: '0 0 24 24' },
                h('path', { strokeLinecap: 'round', strokeLinejoin: 'round', strokeWidth: 2, d: paths[name] })
            );
        }

        function DecorativeBorder() {
            const dots = [];
            for (let i = 0; i < 15; i++) {
                const color = i % 3 === 0 ? '#d4a574' : i % 3 === 1 ? '#8b4513' : '#c87533';
                dots.push(h('div', { key: i, className: 'dot', style: { background: color } }));
            }
            return h('div', { className: 'decorative-dots' }, dots);
        }

        function ProgressBar({ current, total, stage }) {
            const percentage = stage === 'learn' ? (current + 1) / total * 100 : (current + 1) / total * 100;
            return h('div', null,
                h('div', { className: 'progress-bar' },
                    h('div', { className: 'progress-fill', style: { width: percentage + '%' } })
                ),
                h('div', { className: 'progress-text' },
                    h('span', null, (stage === 'learn' ? 'üåø Aprendiendo' : 'üéØ Practicando')),
                    h('span', null, (current + 1) + ' de ' + total)
                )
            );
        }

        function Toast({ achievement, onClose }) {
            useEffect(() => {
                const timer = setTimeout(onClose, 4000);
                return () => clearTimeout(timer);
            }, [onClose]);

            return h('div', { className: 'toast achievement' },
                h('div', { className: 'toast-content' },
                    h('div', { className: 'toast-icon' }, achievement.icon),
                    h('div', { className: 'toast-text' },
                        h('h3', null, '¬°Insignia desbloqueada!'),
                        h('p', null, achievement.name)
                    )
                )
            );
        }

        function BadgesSection({ progress }) {
            const unlockedIds = progress.achievements;
            return h('div', null,
                h('h3', { className: 'text-2xl font-bold text-ochre mb-2 text-center' }, 'üèÖ Insignias'),
                h('div', { className: 'badges-grid' },
                    ...ACHIEVEMENTS.map(badge =>
                        h('div', {
                            key: badge.id,
                            className: 'badge-item' + (unlockedIds.includes(badge.id) ? ' unlocked' : ' locked'),
                            title: badge.description
                        },
                            h('div', { className: 'badge-icon' }, badge.icon),
                            h('div', { className: 'badge-name' }, badge.name),
                            h('div', { className: 'badge-desc' }, badge.description)
                        )
                    )
                )
            );
        }

        function SettingsModal({ onClose, settings, onSettingsChange }) {
            return h('div', null,
                h('div', { className: 'modal-overlay', onClick: onClose }),
                h('div', { className: 'modal-content' },
                    h('div', { className: 'modal-header' },
                        h('h2', { className: 'modal-title' }, '‚öôÔ∏è Configuraci√≥n'),
                        h('button', { className: 'close-btn', onClick: onClose }, '‚úï')
                    ),
                    h('div', { className: 'settings-group' },
                        h('label', { className: 'settings-label' }, 'üîä Audio'),
                        h('div', { className: 'toggle-switch' },
                            h('span', { style: { color: '#f5e6d3' } }, settings.audioEnabled ? '‚úì' : '‚úó'),
                            h('label', { className: 'switch' },
                                h('input', {
                                    type: 'checkbox',
                                    checked: settings.audioEnabled,
                                    onChange: (e) => onSettingsChange({ ...settings, audioEnabled: e.target.checked })
                                }),
                                h('span', { className: 'slider' })
                            ),
                            h('span', { style: { color: '#f5e6d3' } }, settings.audioEnabled ? 'Activado' : 'Desactivado')
                        )
                    ),
                    h('div', { className: 'settings-group' },
                        h('label', { className: 'settings-label' }, 'üìä Velocidad Pronunciaci√≥n'),
                        h('input', {
                            type: 'range',
                            min: '0.5',
                            max: '2',
                            step: '0.1',
                            value: settings.audioSpeed || 0.8,
                            onChange: (e) => onSettingsChange({ ...settings, audioSpeed: parseFloat(e.target.value) }),
                            style: {
                                width: '100%',
                                accentColor: '#d4854a',
                                cursor: 'pointer'
                            }
                        }),
                        h('div', { style: { color: '#e8c490', marginTop: '0.5rem', fontSize: '0.85rem' } },
                            'Velocidad: ' + (settings.audioSpeed || 0.8).toFixed(1) + 'x'
                        )
                    ),
                    h('div', { style: { marginTop: '2rem', textAlign: 'center', color: '#d4a574', fontSize: '0.85rem' } },
                        h('p', null, '‚ú® M√°s ajustes pr√≥ximamente')
                    )
                )
            );
        }

        function LanguageSelector({ onSelect }) {
            return h('div', { className: 'ethnic-pattern' },
                h('div', { className: 'container' },
                    h('div', { className: 'text-center pt-12 mb-12' },
                        h('div', { className: 'text-8xl mb-6 float-animation' }, 'üèîÔ∏è'),
                        h('h1', { className: 'text-5xl font-bold text-ochre mb-4', style: { textShadow: '2px 2px 4px rgba(0,0,0,0.5)' } }, 'Lenguas Ancestrales'),
                        h('p', { className: 'text-xl text-sand mb-2' }, 'de Colombia'),
                        h(DecorativeBorder),
                        h('p', { className: 'text-sand text-lg mt-4' }, 'Preservando la sabidur√≠a de nuestros pueblos originarios'),
                        h('div', { className: 'badge badge-warning mt-4' }, '‚ö†Ô∏è Contenido educativo en desarrollo')
                    ),
                    h('div', { className: 'grid-3 mb-8' },
                        ...LANGUAGES.map(lang =>
                            h('div', {
                                key: lang.id,
                                className: 'card woven-texture lang-card',
                                onClick: () => onSelect(lang)
                            },
                                h('div', { className: 'flex items-center gap-2 mb-3' },
                                    h('div', { className: 'text-5xl' }, lang.icon),
                                    h('div', null,
                                        h('div', { className: 'badge badge-ochre text-xs mb-1' }, lang.region),
                                        h('h2', { className: 'text-2xl font-bold text-sand' }, lang.nativeName)
                                    )
                                ),
                                h('p', { className: 'text-ochre text-sm mb-2' }, lang.name),
                                h('div', { className: 'text-sand text-sm flex items-center gap-2' },
                                    h('span', null, 'üë•'),
                                    h('span', null, lang.speakers)
                                )
                            )
                        )
                    ),
                    h('div', { className: 'mt-12 text-center text-sand text-sm' },
                        h(DecorativeBorder),
                        h('p', null, 'üåø Preservaci√≥n ¬∑ üìö Educaci√≥n ¬∑ ü§ù Respeto Cultural')
                    )
                )
            );
        }

        function Dashboard({ language, progress, onStartLesson, onBack }) {
            const accuracy = LearningEngine.getAccuracy(progress);
            const totalWords = LearningEngine.getTotalWords(progress);
            const lessons = LESSONS[language.id] || [];

            return h('div', { className: 'ethnic-pattern' },
                h('div', { className: 'container' },
                    h('div', { className: 'flex justify-between items-center mb-8' },
                        h('button', { onClick: onBack, className: 'icon-btn' }, h(Icon, { name: 'home' })),
                        h('div', { className: 'badge badge-ochre text-xl' }, language.icon + ' ' + language.nativeName)
                    ),
                    h('div', { className: 'grid grid-3 mb-12' },
                        h('div', { className: 'stats-card' },
                            h('div', { className: 'text-5xl mb-4' }, 'üìö'),
                            h('div', { className: 'text-5xl font-bold text-ochre mb-2' }, totalWords),
                            h('div', { className: 'text-sand text-lg' }, 'Palabras')
                        ),
                        h('div', { className: 'stats-card' },
                            h('div', { className: 'text-5xl mb-4' }, 'üéØ'),
                            h('div', { className: 'text-5xl font-bold text-ochre mb-2' }, accuracy + '%'),
                            h('div', { className: 'text-sand text-lg' }, 'Precisi√≥n')
                        ),
                        h('div', { className: 'stats-card' },
                            h('div', { className: 'text-5xl mb-4' }, 'üî•'),
                            h('div', { className: 'text-5xl font-bold text-ochre mb-2' }, progress.streak),
                            h('div', { className: 'text-sand text-lg' }, 'Racha')
                        )
                    ),
                    h('div', { className: 'card card-static woven-texture mb-12' },
                        h(BadgesSection, { progress: progress })
                    ),
                    h('div', { className: 'card card-static woven-texture' },
                        h('h3', { className: 'text-3xl font-bold text-ochre mb-2 text-center' }, 'Lecciones'),
                        h(DecorativeBorder),
                        h('div', { className: 'mt-8' },
                            ...lessons.map((lesson, i) => {
                                const completed = progress.completedLessons.includes(lesson.id);
                                const locked = i > 0 && !progress.completedLessons.includes(lessons[i - 1].id);
                                return h('div', {
                                    key: lesson.id,
                                    className: 'lesson-card' + (locked ? ' locked' : '')
                                },
                                    h('div', { className: 'flex justify-between items-center' },
                                        h('div', { className: 'flex items-center gap-4' },
                                            h('div', { className: 'text-5xl' }, lesson.icon),
                                            h('div', null,
                                                h('h4', { className: 'text-2xl font-bold text-sand mb-2' },
                                                    lesson.title + (completed ? ' ‚úì' : '')
                                                ),
                                                h('p', { className: 'text-ochre' },
                                                    lesson.words.length + ' palabras ¬∑ Nivel ' + lesson.level
                                                )
                                            )
                                        ),
                                        h('button', {
                                            onClick: () => !locked && onStartLesson(lesson),
                                            disabled: locked,
                                            className: 'btn ' + (locked ? 'btn-secondary' : completed ? 'btn-secondary' : 'btn-primary'),
                                            style: { width: 'auto', padding: '1rem 2rem' }
                                        }, locked ? 'üîí' : completed ? '‚Üª Repasar' : '‚ñ∂ Comenzar')
                                    )
                                );
                            })
                        )
                    )
                )
            );
        }

        function LessonView({ language, lesson, progress, onComplete, onBack }) {
            const [stage, setStage] = useState('learn');
            const [currentIndex, setCurrentIndex] = useState(0);
            const [score, setScore] = useState({ correct: 0, total: 0 });
            const [practiceWords, setPracticeWords] = useState([]);
            const [selected, setSelected] = useState(null);
            const [feedback, setFeedback] = useState(null);

            // Mapeo del idioma al campo de palabra
            const languageFieldMap = {
                'nasa-yuwe': 'nasa',
                'wayuu': 'wayuu',
                'kogi': 'kogi'
            };
            const wordField = languageFieldMap[language.id] || 'nasa';

            useEffect(() => {
                if (stage === 'practice') {
                    setPracticeWords([...lesson.words].sort(() => Math.random() - 0.5));
                }
            }, [stage]);

            const word = stage === 'learn' ? lesson.words[currentIndex] : practiceWords[currentIndex];
            const nativeWord = word ? word[wordField] : '';

            if (stage === 'complete') {
                return h('div', { className: 'ethnic-pattern' },
                    h('div', { className: 'container-sm pt-20' },
                        h('div', { className: 'card card-static woven-texture text-center' },
                            h('div', { className: 'text-8xl mb-8 float-animation' }, 'üèÜ'),
                            h('h2', { className: 'text-5xl font-bold text-ochre mb-4' }, '¬°Felicitaciones!'),
                            h('p', { className: 'text-sand text-xl mb-8' }, 'Has completado ' + lesson.title),
                            h(DecorativeBorder),
                            h('div', { className: 'grid grid-2 mb-8' },
                                h('div', { className: 'stats-card' },
                                    h('div', { className: 'text-5xl font-bold text-ochre' }, score.correct),
                                    h('div', { className: 'text-sand text-lg' }, 'Correctas')
                                ),
                                h('div', { className: 'stats-card' },
                                    h('div', { className: 'text-5xl font-bold text-ochre' }, Math.round((score.correct / score.total) * 100) + '%'),
                                    h('div', { className: 'text-sand text-lg' }, 'Precisi√≥n')
                                )
                            ),
                            h('button', { onClick: () => onComplete(score), className: 'btn btn-primary' }, 'Continuar tu camino ‚Üí')
                        )
                    )
                );
            }

            return h('div', { className: 'ethnic-pattern' },
                h('div', { className: 'container-sm' },
                    h('div', { className: 'flex justify-between items-center mb-4' },
                        h('button', { onClick: onBack, className: 'icon-btn' }, h(Icon, { name: 'home' })),
                        h('div', { className: 'badge badge-ochre' }, lesson.title)
                    ),
                    h(ProgressBar, { current: currentIndex, total: stage === 'learn' ? lesson.words.length : practiceWords.length, stage: stage }),
                    h('div', { className: 'card card-static woven-texture mt-8' },
                        stage === 'learn'
                            ? [
                                h('div', { className: 'text-center mb-8', key: 'content' },
                                    h('div', { className: 'badge badge-ochre text-lg mb-8' }, 'üåø Aprendiendo'),
                                    h('div', { className: 'flex items-center justify-center gap-4 mb-8' },
                                        h('h2', { className: 'text-7xl font-bold text-sand', style: { textShadow: '3px 3px 6px rgba(0,0,0,0.5)' } }, nativeWord),
                                        progress.audioEnabled && h('button', {
                                            onClick: () => AudioEngine.speak(nativeWord),
                                            className: 'icon-btn'
                                        }, h(Icon, { name: 'volume' }))
                                    ),
                                    h('p', { className: 'text-ochre text-xl mb-4 font-bold' }, '[' + word.pronunciation + ']'),
                                    h('div', { className: 'bg-accent mb-4' },
                                        h('p', { className: 'text-3xl text-ochre font-bold mb-2' }, word.spanish),
                                        h('p', { className: 'text-sand text-lg italic' }, word.context)
                                    )
                                ),
                                h(DecorativeBorder, { key: 'border' }),
                                h('button', {
                                    key: 'btn',
                                    onClick: () => {
                                        AudioEngine.stop();
                                        if (currentIndex < lesson.words.length - 1) {
                                            setCurrentIndex(currentIndex + 1);
                                        } else {
                                            setStage('practice');
                                            setCurrentIndex(0);
                                        }
                                    },
                                    className: 'btn btn-primary'
                                }, (currentIndex < lesson.words.length - 1 ? 'Siguiente palabra' : 'Comenzar pr√°ctica') + ' ‚Üí')
                            ]
                            : [
                                h('div', { className: 'text-center mb-12', key: 'content' },
                                    h('div', { className: 'badge badge-ochre text-lg mb-8' }, 'üéØ ¬øQu√© significa?'),
                                    h('h2', { className: 'text-7xl font-bold text-sand mb-4', style: { textShadow: '3px 3px 6px rgba(0,0,0,0.5)' } }, nativeWord)
                                ),
                                h('div', { key: 'options' },
                                    ...(() => {
                                        const others = lesson.words.filter(w => w.id !== word.id).sort(() => Math.random() - 0.5).slice(0, 2);
                                        return [...others, word].sort(() => Math.random() - 0.5).map((w, i) =>
                                            h('button', {
                                                key: i,
                                                onClick: () => {
                                                    if (!selected) {
                                                        const correct = w.spanish === word.spanish;
                                                        setSelected(w.spanish);
                                                        setFeedback(correct ? 'correct' : 'incorrect');
                                                        if (correct && progress.audioEnabled) AudioEngine.speak(nativeWord);
                                                        setScore({ correct: score.correct + (correct ? 1 : 0), total: score.total + 1 });
                                                        setTimeout(() => {
                                                            if (currentIndex < practiceWords.length - 1) {
                                                                setCurrentIndex(currentIndex + 1);
                                                                setSelected(null);
                                                                setFeedback(null);
                                                            } else {
                                                                setStage('complete');
                                                            }
                                                        }, 1500);
                                                    }
                                                },
                                                disabled: !!selected,
                                                className: 'option-btn' + (selected === w.spanish ? ' ' + feedback : '')
                                            },
                                                h('span', null, w.spanish),
                                                selected === w.spanish && h(Icon, { name: feedback === 'correct' ? 'check' : 'x' })
                                            )
                                        );
                                    })()
                                )
                            ]
                    )
                )
            );
        }

        function App() {
            const [screen, setScreen] = useState('select');
            const [language, setLanguage] = useState(null);
            const [progress, setProgress] = useState(null);
            const [lesson, setLesson] = useState(null);
            const [newAchievement, setNewAchievement] = useState(null);
            const [showSettings, setShowSettings] = useState(false);
            const [settings, setSettings] = useState({ audioEnabled: true, audioSpeed: 0.8 });

            useEffect(() => {
                if (language) {
                    let prog = Storage.loadProgress(language.id);
                    if (!prog) {
                        prog = LearningEngine.initProgress(language.id);
                        Storage.saveProgress(prog);
                    }
                    setProgress(prog);
                }
            }, [language]);

            const handleSettingsChange = (newSettings) => {
                setSettings(newSettings);
                if (progress) {
                    const updated = Object.assign({}, progress, { audioEnabled: newSettings.audioEnabled });
                    setProgress(updated);
                    Storage.saveProgress(updated);
                }
            };

            const renderContent = () => {
                if (screen === 'select') {
                    return h(LanguageSelector, {
                        onSelect: (lang) => {
                            setLanguage(lang);
                            setScreen('dashboard');
                        }
                    });
                }

                if (screen === 'dashboard' && progress) {
                    return h(Dashboard, {
                        language,
                        progress,
                        onStartLesson: (les) => {
                            setLesson(les);
                            setScreen('lesson');
                        },
                        onBack: () => {
                            setScreen('select');
                            setLanguage(null);
                            setProgress(null);
                        }
                    });
                }

                if (screen === 'lesson' && lesson) {
                    return h(LessonView, {
                        language,
                        lesson,
                        progress,
                        onComplete: (score) => {
                            let updated = LearningEngine.completeLesson(progress, lesson.id, score);
                            lesson.words.forEach(w => {
                                updated = LearningEngine.learnWord(updated, w.id);
                            });
                            updated = LearningEngine.checkAchievements(updated);
                            
                            const newAchs = ACHIEVEMENTS.filter(a => 
                                updated.achievements.includes(a.id) && 
                                !progress.achievements.includes(a.id)
                            );
                            
                            if (newAchs.length > 0) {
                                setNewAchievement(newAchs[0]);
                            }
                            
                            Storage.saveProgress(updated);
                            setProgress(updated);
                            setScreen('dashboard');
                        },
                        onBack: () => {
                            AudioEngine.stop();
                            setScreen('select');
                        }
                    });
                }

                return null;
            };

            return h('div', null,
                renderContent(),
                h('button', {
                    className: 'settings-btn',
                    onClick: () => setShowSettings(true),
                    title: 'Configuraci√≥n'
                }, '‚öôÔ∏è'),
                showSettings && h(SettingsModal, {
                    onClose: () => setShowSettings(false),
                    settings: settings,
                    onSettingsChange: handleSettingsChange
                }),
                newAchievement && h(Toast, {
                    achievement: newAchievement,
                    onClose: () => setNewAchievement(null)
                })
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(h(App));
    </script>
</body>
</html>